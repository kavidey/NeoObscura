/*********************************************************************
*                    SEGGER Microcontroller GmbH                     *
*                        The Embedded Experts                        *
**********************************************************************

-------------------------- END-OF-HEADER -----------------------------

File    : main.c
Purpose : Generic application start

*/



#include <stdio.h>
#include <stm32l432xx.h>
#include "/Users/neilchulani/Documents/Polarbear/College/Classes/Engineering/MicroPs/HMC-E155/lab/lab07/lab07_mcu/lib/STM32L432KC.h"
#include <time.h>

#define MSPI                PA6
#define reset               PA5
#define encodedByteReady    PA4
#define readyForPixel       PA3
#define finalPixel          PA1
#define doneEncoding        PA2

struct pixel {
    uint8_t r;
    uint8_t g;
    uint8_t b;
    uint8_t a;
};

int main(void) {

  RCC->AHB2ENR |= (RCC_AHB2ENR_GPIOAEN | RCC_AHB2ENR_GPIOBEN | RCC_AHB2ENR_GPIOCEN);

  // Load and done pins
  pinMode(reset, GPIO_OUTPUT);  // reset
  pinMode(MSPI, GPIO_OUTPUT);  // mcu performing spi
  pinMode(finalPixel, GPIO_OUTPUT);
  pinMode(encodedByteReady, GPIO_INPUT);   // chunkReady
  pinMode(readyForPixel, GPIO_INPUT);   // ready for data
  pinMode(doneEncoding, GPIO_INPUT);

  int numPixels = 1200;

  // initialize random pixels
  struct pixel pixels[1200] = {
    { 190, 70, 224, 213 },
    { 121, 200, 89, 58 },
    { 58, 62, 234, 181 },
    { 108, 113, 110, 115 },
    { 110, 96, 55, 69 },
    { 221, 12, 144, 28 },
    { 52, 105, 66, 230 },
    { 212, 35, 99, 12 },
    { 42, 181, 110, 186 },
    { 168, 51, 228, 20 },
    { 71, 25, 253, 80 },
    { 37, 6, 101, 2 },
    { 144, 228, 61, 189 },
    { 106, 24, 240, 102 },
    { 112, 234, 139, 219 },
    { 54, 194, 55, 74 },
    { 187, 175, 36, 186 },
    { 131, 28, 239, 240 },
    { 168, 114, 193, 240 },
    { 230, 226, 176, 243 },
    { 198, 166, 192, 55 },
    { 59, 169, 79, 106 },
    { 158, 147, 35, 29 },
    { 214, 255, 24, 118 },
    { 71, 86, 209, 41 },
    { 139, 126, 96, 234 },
    { 27, 22, 154, 174 },
    { 7, 103, 253, 9 },
    { 36, 158, 73, 179 },
    { 182, 202, 190, 148 },
    { 183, 160, 174, 23 },
    { 114, 209, 114, 219 },
    { 100, 54, 127, 27 },
    { 6, 254, 54, 149 },
    { 99, 255, 20, 198 },
    { 99, 99, 97, 117 },
    { 243, 188, 44, 64 },
    { 68, 229, 218, 8 },
    { 224, 213, 234, 71 },
    { 38, 92, 104, 38 },
    { 129, 67, 30, 1 },
    { 190, 157, 105, 43 },
    { 243, 43, 44, 245 },
    { 224, 118, 196, 228 },
    { 247, 217, 26, 145 },
    { 213, 134, 35, 196 },
    { 28, 184, 208, 195 },
    { 105, 210, 13, 241 },
    { 235, 189, 200, 92 },
    { 97, 94, 26, 166 },
    { 138, 34, 207, 80 },
    { 68, 206, 187, 170 },
    { 167, 252, 130, 204 },
    { 167, 152, 156, 183 },
    { 144, 71, 144, 21 },
    { 239, 178, 214, 134 },
    { 248, 14, 2, 29 },
    { 47, 47, 138, 140 },
    { 74, 1, 20, 254 },
    { 162, 194, 150, 163 },
    { 7, 165, 29, 37 },
    { 13, 76, 150, 88 },
    { 48, 188, 220, 94 },
    { 126, 83, 82, 135 },
    { 166, 96, 70, 242 },
    { 25, 175, 63, 241 },
    { 181, 125, 71, 5 },
    { 134, 226, 118, 175 },
    { 80, 99, 214, 252 },
    { 227, 65, 184, 57 },
    { 232, 38, 125, 242 },
    { 110, 34, 174, 179 },
    { 36, 142, 238, 139 },
    { 92, 120, 186, 26 },
    { 130, 161, 176, 86 },
    { 120, 116, 179, 100 },
    { 42, 188, 118, 119 },
    { 76, 42, 198, 224 },
    { 71, 108, 76, 146 },
    { 41, 134, 83, 46 },
    { 11, 164, 236, 208 },
    { 186, 18, 86, 80 },
    { 174, 148, 183, 83 },
    { 109, 202, 103, 254 },
    { 134, 161, 69, 76 },
    { 213, 235, 188, 59 },
    { 246, 226, 240, 157 },
    { 122, 222, 189, 120 },
    { 1, 185, 190, 241 },
    { 207, 57, 12, 102 },
    { 89, 59, 90, 208 },
    { 239, 6, 187, 47 },
    { 67, 75, 127, 71 },
    { 248, 190, 196, 17 },
    { 243, 72, 152, 255 },
    { 184, 230, 118, 164 },
    { 120, 178, 224, 83 },
    { 42, 121, 41, 119 },
    { 221, 10, 157, 155 },
    { 101, 128, 153, 22 },
    { 161, 201, 11, 21 },
    { 124, 175, 155, 195 },
    { 201, 210, 111, 237 },
    { 0, 3, 25, 136 },
    { 86, 162, 164, 44 },
    { 6, 105, 255, 16 },
    { 203, 71, 28, 73 },
    { 47, 180, 252, 158 },
    { 29, 65, 18, 65 },
    { 212, 164, 91, 189 },
    { 161, 171, 254, 54 },
    { 102, 242, 152, 1 },
    { 38, 165, 168, 9 },
    { 161, 102, 44, 221 },
    { 171, 17, 220, 208 },
    { 44, 167, 255, 223 },
    { 115, 51, 32, 137 },
    { 151, 7, 123, 113 },
    { 181, 216, 1, 41 },
    { 220, 192, 46, 203 },
    { 181, 103, 219, 252 },
    { 3, 230, 26, 119 },
    { 70, 200, 30, 45 },
    { 168, 204, 145, 73 },
    { 170, 18, 186, 140 },
    { 76, 152, 112, 97 },
    { 153, 118, 145, 141 },
    { 177, 204, 106, 98 },
    { 184, 177, 125, 74 },
    { 187, 46, 138, 114 },
    { 117, 123, 238, 47 },
    { 25, 0, 60, 173 },
    { 157, 125, 196, 42 },
    { 152, 232, 199, 143 },
    { 20, 236, 216, 187 },
    { 203, 180, 79, 133 },
    { 170, 215, 84, 139 },
    { 66, 59, 31, 149 },
    { 158, 174, 123, 250 },
    { 48, 174, 190, 148 },
    { 13, 215, 120, 204 },
    { 116, 166, 24, 111 },
    { 128, 74, 70, 49 },
    { 10, 248, 207, 157 },
    { 42, 31, 3, 0 },
    { 126, 75, 178, 176 },
    { 203, 123, 90, 89 },
    { 81, 222, 49, 0 },
    { 246, 252, 186, 23 },
    { 39, 55, 90, 232 },
    { 127, 195, 189, 103 },
    { 87, 44, 255, 52 },
    { 66, 82, 250, 30 },
    { 231, 88, 109, 115 },
    { 186, 199, 126, 77 },
    { 206, 91, 190, 226 },
    { 26, 19, 239, 60 },
    { 2, 107, 0, 215 },
    { 249, 188, 111, 175 },
    { 119, 31, 130, 72 },
    { 251, 101, 196, 182 },
    { 58, 231, 158, 128 },
    { 10, 83, 39, 35 },
    { 100, 118, 30, 151 },
    { 127, 251, 233, 127 },
    { 120, 198, 54, 188 },
    { 115, 15, 180, 186 },
    { 120, 190, 103, 188 },
    { 147, 69, 54, 50 },
    { 151, 161, 102, 34 },
    { 248, 157, 160, 218 },
    { 47, 43, 102, 150 },
    { 191, 233, 61, 95 },
    { 115, 116, 204, 117 },
    { 126, 251, 213, 43 },
    { 128, 73, 48, 172 },
    { 108, 189, 148, 148 },
    { 93, 72, 188, 34 },
    { 8, 0, 4, 153 },
    { 117, 208, 240, 251 },
    { 41, 44, 251, 148 },
    { 214, 244, 175, 9 },
    { 204, 166, 186, 53 },
    { 228, 111, 44, 250 },
    { 34, 101, 214, 165 },
    { 173, 150, 210, 211 },
    { 91, 25, 0, 249 },
    { 10, 249, 122, 86 },
    { 50, 237, 20, 105 },
    { 76, 71, 51, 74 },
    { 232, 140, 109, 175 },
    { 230, 44, 208, 21 },
    { 196, 85, 194, 1 },
    { 23, 195, 28, 133 },
    { 32, 204, 101, 234 },
    { 153, 217, 150, 250 },
    { 33, 247, 232, 119 },
    { 44, 52, 122, 90 },
    { 78, 125, 227, 71 },
    { 170, 205, 163, 38 },
    { 97, 36, 197, 53 },
    { 2, 87, 251, 87 },
    { 163, 44, 175, 195 },
    { 71, 43, 190, 59 },
    { 120, 29, 103, 219 },
    { 107, 255, 244, 153 },
    { 240, 212, 40, 27 },
    { 214, 57, 141, 167 },
    { 224, 51, 126, 254 },
    { 16, 164, 234, 62 },
    { 62, 61, 123, 7 },
    { 25, 176, 82, 161 },
    { 85, 224, 103, 242 },
    { 164, 136, 253, 122 },
    { 46, 225, 236, 161 },
    { 80, 94, 173, 53 },
    { 236, 201, 49, 213 },
    { 33, 196, 185, 130 },
    { 44, 88, 145, 245 },
    { 45, 145, 177, 189 },
    { 194, 139, 105, 19 },
    { 222, 231, 175, 130 },
    { 68, 232, 127, 83 },
    { 252, 214, 212, 172 },
    { 61, 7, 228, 100 },
    { 170, 230, 86, 45 },
    { 153, 40, 21, 149 },
    { 215, 218, 191, 162 },
    { 57, 53, 124, 157 },
    { 56, 234, 37, 124 },
    { 191, 174, 220, 153 },
    { 228, 147, 186, 141 },
    { 24, 111, 177, 79 },
    { 8, 67, 74, 205 },
    { 132, 77, 152, 134 },
    { 150, 70, 90, 200 },
    { 111, 60, 122, 27 },
    { 106, 198, 171, 42 },
    { 11, 110, 88, 47 },
    { 104, 177, 189, 248 },
    { 183, 52, 127, 143 },
    { 97, 114, 144, 206 },
    { 71, 147, 226, 244 },
    { 204, 149, 253, 6 },
    { 14, 117, 132, 120 },
    { 99, 66, 26, 134 },
    { 90, 194, 234, 160 },
    { 18, 158, 227, 10 },
    { 111, 176, 222, 253 },
    { 227, 234, 197, 63 },
    { 208, 11, 138, 32 },
    { 10, 222, 149, 94 },
    { 109, 254, 201, 208 },
    { 207, 127, 82, 175 },
    { 25, 236, 97, 64 },
    { 149, 232, 56, 119 },
    { 169, 102, 84, 239 },
    { 135, 38, 216, 165 },
    { 35, 213, 36, 161 },
    { 84, 163, 218, 224 },
    { 223, 131, 143, 147 },
    { 143, 118, 1, 173 },
    { 18, 144, 97, 124 },
    { 171, 191, 178, 20 },
    { 152, 211, 113, 240 },
    { 225, 183, 33, 58 },
    { 172, 202, 133, 124 },
    { 195, 39, 138, 7 },
    { 29, 145, 28, 88 },
    { 3, 136, 222, 72 },
    { 230, 166, 24, 221 },
    { 249, 19, 240, 158 },
    { 212, 250, 50, 101 },
    { 244, 87, 193, 212 },
    { 113, 185, 47, 152 },
    { 93, 88, 183, 233 },
    { 27, 36, 206, 52 },
    { 170, 27, 15, 99 },
    { 187, 36, 185, 151 },
    { 59, 227, 46, 98 },
    { 103, 151, 113, 69 },
    { 213, 1, 201, 140 },
    { 243, 61, 48, 115 },
    { 244, 227, 170, 59 },
    { 55, 26, 6, 172 },
    { 32, 244, 79, 99 },
    { 244, 6, 192, 80 },
    { 236, 96, 254, 80 },
    { 187, 181, 215, 114 },
    { 71, 117, 8, 164 },
    { 57, 245, 135, 39 },
    { 118, 104, 39, 195 },
    { 198, 60, 233, 70 },
    { 145, 141, 251, 60 },
    { 122, 182, 207, 205 },
    { 214, 16, 37, 228 },
    { 77, 116, 16, 250 },
    { 251, 157, 202, 254 },
    { 149, 18, 147, 56 },
    { 233, 125, 25, 178 },
    { 190, 57, 2, 56 },
    { 21, 160, 109, 203 },
    { 1, 70, 135, 214 },
    { 4, 68, 200, 12 },
    { 60, 55, 226, 68 },
    { 27, 27, 180, 80 },
    { 53, 19, 143, 191 },
    { 188, 172, 95, 120 },
    { 216, 39, 126, 199 },
    { 235, 70, 190, 47 },
    { 90, 147, 50, 225 },
    { 81, 111, 207, 170 },
    { 233, 50, 39, 251 },
    { 179, 220, 196, 78 },
    { 126, 90, 148, 147 },
    { 55, 0, 98, 14 },
    { 118, 76, 198, 180 },
    { 66, 84, 130, 238 },
    { 215, 47, 125, 14 },
    { 207, 178, 103, 24 },
    { 40, 104, 109, 139 },
    { 174, 54, 72, 211 },
    { 17, 51, 132, 72 },
    { 61, 17, 188, 33 },
    { 195, 187, 151, 248 },
    { 74, 205, 83, 254 },
    { 205, 40, 45, 45 },
    { 156, 225, 60, 57 },
    { 172, 140, 165, 239 },
    { 40, 42, 159, 217 },
    { 116, 132, 83, 29 },
    { 254, 118, 207, 138 },
    { 30, 143, 174, 126 },
    { 27, 65, 196, 161 },
    { 20, 132, 44, 115 },
    { 233, 250, 234, 136 },
    { 181, 190, 83, 168 },
    { 129, 25, 209, 96 },
    { 137, 59, 201, 230 },
    { 253, 157, 236, 129 },
    { 202, 125, 45, 105 },
    { 14, 88, 125, 62 },
    { 51, 88, 70, 226 },
    { 5, 127, 42, 163 },
    { 13, 52, 107, 235 },
    { 3, 117, 38, 193 },
    { 202, 253, 0, 103 },
    { 69, 244, 126, 43 },
    { 199, 223, 110, 140 },
    { 165, 137, 79, 243 },
    { 25, 215, 202, 95 },
    { 102, 35, 190, 239 },
    { 155, 233, 78, 167 },
    { 12, 220, 75, 192 },
    { 162, 221, 49, 50 },
    { 5, 188, 122, 250 },
    { 154, 160, 112, 202 },
    { 188, 134, 51, 84 },
    { 142, 86, 243, 3 },
    { 222, 147, 158, 247 },
    { 211, 95, 45, 69 },
    { 90, 251, 117, 248 },
    { 99, 158, 194, 44 },
    { 221, 6, 128, 252 },
    { 245, 220, 3, 36 },
    { 189, 57, 97, 141 },
    { 242, 214, 32, 35 },
    { 134, 70, 46, 28 },
    { 42, 179, 116, 139 },
    { 116, 248, 84, 159 },
    { 126, 19, 150, 52 },
    { 2, 113, 226, 98 },
    { 210, 101, 117, 170 },
    { 154, 227, 41, 33 },
    { 4, 207, 11, 19 },
    { 88, 222, 130, 195 },
    { 226, 67, 40, 51 },
    { 30, 184, 66, 39 },
    { 169, 137, 148, 48 },
    { 55, 217, 113, 88 },
    { 100, 250, 86, 104 },
    { 104, 32, 61, 37 },
    { 89, 22, 1, 212 },
    { 155, 210, 88, 11 },
    { 15, 97, 119, 128 },
    { 34, 73, 88, 254 },
    { 132, 163, 125, 46 },
    { 156, 100, 140, 78 },
    { 11, 55, 129, 130 },
    { 72, 143, 113, 211 },
    { 224, 246, 132, 175 },
    { 150, 86, 40, 79 },
    { 229, 219, 47, 97 },
    { 200, 192, 118, 157 },
    { 154, 186, 55, 177 },
    { 122, 165, 15, 49 },
    { 211, 244, 153, 12 },
    { 34, 160, 67, 149 },
    { 58, 197, 243, 41 },
    { 140, 55, 143, 213 },
    { 255, 254, 210, 47 },
    { 137, 226, 148, 234 },
    { 147, 180, 179, 49 },
    { 204, 31, 121, 218 },
    { 237, 56, 38, 44 },
    { 208, 69, 82, 40 },
    { 175, 204, 10, 216 },
    { 98, 30, 240, 23 },
    { 27, 43, 10, 199 },
    { 140, 65, 46, 149 },
    { 182, 114, 92, 114 },
    { 99, 214, 203, 137 },
    { 85, 171, 216, 154 },
    { 106, 158, 76, 241 },
    { 141, 166, 110, 124 },
    { 76, 14, 97, 13 },
    { 193, 253, 93, 204 },
    { 124, 76, 243, 193 },
    { 8, 209, 14, 13 },
    { 144, 163, 168, 82 },
    { 203, 202, 150, 114 },
    { 125, 225, 233, 240 },
    { 194, 192, 146, 233 },
    { 63, 80, 220, 245 },
    { 195, 174, 175, 172 },
    { 27, 48, 172, 223 },
    { 148, 220, 66, 139 },
    { 171, 62, 54, 157 },
    { 28, 115, 80, 81 },
    { 79, 81, 159, 0 },
    { 2, 197, 132, 148 },
    { 206, 89, 82, 251 },
    { 103, 79, 181, 173 },
    { 206, 248, 118, 114 },
    { 68, 234, 42, 165 },
    { 133, 79, 129, 72 },
    { 96, 41, 130, 93 },
    { 166, 33, 211, 247 },
    { 181, 160, 40, 88 },
    { 207, 106, 90, 41 },
    { 98, 164, 160, 155 },
    { 248, 90, 172, 163 },
    { 29, 198, 176, 234 },
    { 126, 88, 231, 219 },
    { 160, 31, 55, 10 },
    { 175, 38, 172, 130 },
    { 32, 98, 221, 146 },
    { 115, 100, 196, 153 },
    { 214, 147, 185, 226 },
    { 216, 138, 165, 95 },
    { 40, 86, 186, 237 },
    { 71, 230, 230, 77 },
    { 82, 195, 222, 61 },
    { 238, 163, 102, 160 },
    { 217, 78, 93, 171 },
    { 66, 205, 67, 4 },
    { 62, 121, 60, 58 },
    { 210, 158, 12, 235 },
    { 163, 211, 188, 8 },
    { 118, 146, 69, 216 },
    { 132, 122, 75, 27 },
    { 157, 228, 223, 223 },
    { 162, 78, 12, 40 },
    { 111, 172, 69, 212 },
    { 197, 132, 248, 234 },
    { 24, 116, 56, 35 },
    { 107, 21, 104, 23 },
    { 139, 79, 232, 110 },
    { 132, 130, 254, 121 },
    { 19, 238, 123, 168 },
    { 151, 163, 162, 54 },
    { 185, 199, 191, 65 },
    { 205, 174, 113, 199 },
    { 65, 158, 81, 169 },
    { 193, 120, 166, 41 },
    { 88, 141, 213, 178 },
    { 102, 17, 26, 15 },
    { 148, 22, 147, 39 },
    { 223, 229, 141, 245 },
    { 222, 97, 107, 184 },
    { 172, 221, 9, 150 },
    { 218, 241, 56, 21 },
    { 49, 104, 255, 15 },
    { 5, 23, 152, 162 },
    { 241, 16, 228, 117 },
    { 54, 11, 254, 255 },
    { 149, 95, 159, 225 },
    { 38, 162, 123, 119 },
    { 140, 94, 116, 92 },
    { 116, 132, 116, 108 },
    { 64, 216, 212, 212 },
    { 13, 8, 21, 33 },
    { 74, 146, 82, 113 },
    { 3, 43, 163, 188 },
    { 78, 158, 170, 100 },
    { 124, 147, 178, 232 },
    { 31, 241, 76, 44 },
    { 9, 187, 105, 184 },
    { 65, 61, 58, 37 },
    { 183, 209, 190, 39 },
    { 204, 196, 218, 188 },
    { 197, 9, 245, 32 },
    { 116, 45, 52, 75 },
    { 191, 7, 251, 230 },
    { 131, 247, 131, 42 },
    { 10, 39, 34, 118 },
    { 138, 108, 40, 48 },
    { 226, 195, 111, 4 },
    { 196, 81, 172, 118 },
    { 46, 251, 219, 183 },
    { 21, 209, 181, 15 },
    { 36, 177, 6, 207 },
    { 251, 187, 214, 57 },
    { 156, 86, 140, 62 },
    { 27, 247, 27, 120 },
    { 209, 51, 204, 66 },
    { 78, 251, 226, 78 },
    { 204, 165, 205, 60 },
    { 225, 150, 182, 93 },
    { 254, 147, 162, 99 },
    { 60, 171, 43, 83 },
    { 34, 191, 61, 97 },
    { 171, 173, 108, 117 },
    { 222, 78, 18, 23 },
    { 0, 227, 134, 31 },
    { 236, 183, 159, 163 },
    { 41, 9, 69, 237 },
    { 250, 203, 20, 5 },
    { 68, 219, 249, 188 },
    { 72, 152, 170, 242 },
    { 41, 232, 225, 79 },
    { 151, 241, 216, 183 },
    { 243, 33, 145, 73 },
    { 123, 77, 224, 137 },
    { 234, 42, 224, 81 },
    { 8, 56, 193, 27 },
    { 201, 70, 62, 217 },
    { 33, 185, 199, 100 },
    { 98, 30, 205, 154 },
    { 52, 217, 197, 14 },
    { 97, 190, 154, 209 },
    { 25, 227, 245, 169 },
    { 94, 214, 59, 84 },
    { 141, 53, 47, 13 },
    { 6, 242, 126, 50 },
    { 129, 12, 223, 47 },
    { 212, 238, 126, 79 },
    { 188, 198, 196, 36 },
    { 134, 105, 74, 73 },
    { 92, 29, 16, 73 },
    { 136, 82, 148, 78 },
    { 154, 182, 205, 11 },
    { 163, 44, 19, 124 },
    { 241, 214, 201, 58 },
    { 162, 65, 198, 184 },
    { 237, 177, 185, 33 },
    { 223, 35, 78, 253 },
    { 35, 178, 71, 184 },
    { 29, 36, 232, 202 },
    { 74, 67, 178, 123 },
    { 105, 85, 70, 152 },
    { 119, 56, 199, 163 },
    { 33, 23, 113, 190 },
    { 18, 4, 49, 218 },
    { 61, 51, 26, 192 },
    { 92, 125, 147, 127 },
    { 126, 245, 191, 149 },
    { 13, 124, 87, 156 },
    { 138, 181, 93, 233 },
    { 64, 7, 15, 209 },
    { 114, 245, 63, 66 },
    { 168, 178, 179, 188 },
    { 138, 35, 239, 233 },
    { 44, 220, 150, 193 },
    { 159, 242, 162, 247 },
    { 78, 254, 198, 24 },
    { 199, 225, 244, 158 },
    { 175, 198, 194, 15 },
    { 125, 110, 18, 34 },
    { 92, 133, 174, 163 },
    { 36, 124, 69, 141 },
    { 0, 100, 244, 55 },
    { 13, 94, 175, 19 },
    { 252, 77, 111, 124 },
    { 194, 159, 155, 225 },
    { 212, 162, 243, 182 },
    { 130, 127, 152, 146 },
    { 101, 145, 93, 162 },
    { 109, 87, 152, 45 },
    { 235, 144, 48, 109 },
    { 54, 140, 8, 95 },
    { 174, 25, 132, 201 },
    { 117, 189, 17, 234 },
    { 209, 228, 15, 148 },
    { 225, 246, 27, 91 },
    { 42, 52, 50, 37 },
    { 213, 95, 207, 49 },
    { 225, 118, 122, 127 },
    { 174, 193, 85, 178 },
    { 179, 111, 52, 136 },
    { 35, 182, 110, 185 },
    { 74, 113, 0, 235 },
    { 30, 20, 102, 118 },
    { 69, 117, 90, 110 },
    { 242, 145, 104, 123 },
    { 239, 42, 193, 139 },
    { 172, 4, 183, 22 },
    { 183, 36, 204, 50 },
    { 44, 13, 128, 18 },
    { 150, 51, 184, 73 },
    { 39, 147, 158, 255 },
    { 66, 160, 189, 138 },
    { 145, 61, 40, 78 },
    { 113, 124, 154, 202 },
    { 49, 4, 222, 220 },
    { 47, 102, 223, 212 },
    { 74, 124, 153, 103 },
    { 181, 24, 71, 171 },
    { 110, 24, 85, 12 },
    { 198, 143, 232, 217 },
    { 191, 153, 195, 204 },
    { 170, 169, 123, 244 },
    { 194, 67, 33, 63 },
    { 127, 79, 103, 118 },
    { 90, 199, 60, 251 },
    { 20, 223, 17, 31 },
    { 228, 28, 157, 19 },
    { 44, 74, 38, 190 },
    { 122, 4, 234, 33 },
    { 196, 168, 221, 199 },
    { 191, 21, 186, 125 },
    { 219, 37, 215, 173 },
    { 130, 42, 109, 144 },
    { 2, 235, 212, 18 },
    { 53, 242, 209, 244 },
    { 163, 161, 30, 54 },
    { 243, 86, 157, 243 },
    { 85, 20, 145, 37 },
    { 119, 184, 96, 38 },
    { 54, 206, 109, 104 },
    { 88, 195, 202, 170 },
    { 14, 106, 40, 132 },
    { 214, 232, 141, 86 },
    { 30, 165, 53, 177 },
    { 120, 59, 30, 198 },
    { 5, 38, 156, 32 },
    { 183, 160, 243, 122 },
    { 32, 237, 44, 139 },
    { 10, 182, 235, 217 },
    { 166, 178, 64, 67 },
    { 160, 228, 177, 85 },
    { 55, 166, 150, 158 },
    { 197, 97, 49, 229 },
    { 10, 226, 194, 174 },
    { 168, 168, 249, 231 },
    { 48, 173, 99, 48 },
    { 196, 200, 2, 197 },
    { 108, 131, 76, 232 },
    { 171, 140, 52, 2 },
    { 77, 234, 127, 125 },
    { 130, 31, 217, 142 },
    { 215, 199, 50, 254 },
    { 244, 171, 15, 229 },
    { 73, 69, 109, 142 },
    { 45, 100, 120, 136 },
    { 125, 113, 130, 106 },
    { 39, 134, 157, 255 },
    { 196, 93, 181, 161 },
    { 252, 210, 149, 65 },
    { 212, 26, 174, 27 },
    { 46, 21, 188, 239 },
    { 117, 51, 164, 176 },
    { 223, 39, 156, 12 },
    { 184, 6, 196, 143 },
    { 47, 242, 66, 73 },
    { 2, 34, 219, 232 },
    { 187, 152, 5, 11 },
    { 90, 147, 122, 195 },
    { 183, 12, 165, 134 },
    { 50, 26, 58, 96 },
    { 117, 121, 171, 174 },
    { 99, 133, 219, 117 },
    { 13, 58, 241, 26 },
    { 150, 176, 211, 163 },
    { 207, 215, 35, 161 },
    { 7, 75, 161, 40 },
    { 58, 54, 217, 198 },
    { 141, 222, 37, 12 },
    { 10, 254, 94, 102 },
    { 193, 195, 220, 203 },
    { 223, 255, 142, 127 },
    { 46, 185, 213, 81 },
    { 172, 13, 194, 247 },
    { 250, 226, 185, 239 },
    { 112, 250, 254, 176 },
    { 0, 102, 80, 119 },
    { 17, 251, 113, 36 },
    { 12, 206, 185, 174 },
    { 175, 51, 3, 6 },
    { 160, 102, 72, 123 },
    { 73, 234, 44, 220 },
    { 38, 117, 230, 226 },
    { 245, 114, 81, 125 },
    { 147, 212, 174, 53 },
    { 193, 198, 173, 24 },
    { 145, 245, 9, 110 },
    { 148, 116, 187, 174 },
    { 136, 252, 234, 202 },
    { 245, 140, 248, 213 },
    { 129, 51, 183, 27 },
    { 177, 192, 121, 12 },
    { 204, 176, 212, 163 },
    { 150, 50, 131, 72 },
    { 71, 174, 245, 20 },
    { 53, 125, 227, 62 },
    { 72, 153, 139, 99 },
    { 48, 161, 238, 14 },
    { 80, 52, 236, 112 },
    { 151, 223, 43, 127 },
    { 253, 132, 29, 54 },
    { 217, 99, 5, 234 },
    { 115, 203, 149, 50 },
    { 239, 23, 53, 219 },
    { 149, 33, 82, 157 },
    { 41, 82, 219, 75 },
    { 157, 152, 27, 79 },
    { 252, 7, 155, 249 },
    { 62, 2, 168, 235 },
    { 133, 188, 191, 72 },
    { 62, 140, 12, 157 },
    { 127, 170, 62, 172 },
    { 148, 114, 28, 149 },
    { 95, 15, 8, 177 },
    { 35, 17, 220, 27 },
    { 106, 65, 215, 232 },
    { 151, 235, 28, 9 },
    { 90, 251, 10, 186 },
    { 46, 200, 213, 235 },
    { 75, 242, 55, 88 },
    { 182, 117, 81, 70 },
    { 68, 134, 100, 218 },
    { 151, 82, 194, 189 },
    { 240, 208, 159, 241 },
    { 224, 131, 174, 49 },
    { 242, 130, 33, 209 },
    { 20, 250, 108, 55 },
    { 79, 239, 82, 83 },
    { 108, 24, 173, 75 },
    { 237, 253, 222, 254 },
    { 245, 182, 29, 219 },
    { 182, 143, 125, 125 },
    { 237, 15, 46, 144 },
    { 150, 105, 72, 158 },
    { 126, 235, 36, 94 },
    { 196, 153, 215, 43 },
    { 95, 183, 38, 216 },
    { 28, 107, 47, 131 },
    { 20, 139, 255, 97 },
    { 21, 171, 239, 236 },
    { 243, 132, 146, 32 },
    { 194, 190, 54, 178 },
    { 233, 206, 95, 91 },
    { 179, 221, 229, 43 },
    { 248, 92, 7, 236 },
    { 235, 196, 68, 167 },
    { 23, 250, 56, 188 },
    { 177, 57, 41, 73 },
    { 31, 58, 24, 22 },
    { 123, 193, 48, 6 },
    { 175, 112, 142, 129 },
    { 238, 80, 160, 155 },
    { 146, 192, 107, 79 },
    { 99, 160, 250, 178 },
    { 133, 90, 71, 191 },
    { 71, 64, 95, 50 },
    { 128, 45, 35, 110 },
    { 154, 196, 112, 172 },
    { 165, 47, 233, 160 },
    { 37, 193, 75, 225 },
    { 143, 176, 192, 21 },
    { 236, 75, 248, 194 },
    { 84, 168, 56, 34 },
    { 125, 36, 77, 173 },
    { 47, 177, 209, 223 },
    { 190, 1, 106, 206 },
    { 106, 130, 111, 67 },
    { 181, 57, 136, 1 },
    { 120, 203, 126, 185 },
    { 96, 67, 42, 45 },
    { 140, 168, 70, 118 },
    { 35, 88, 151, 237 },
    { 50, 139, 57, 208 },
    { 82, 30, 232, 121 },
    { 174, 112, 94, 255 },
    { 87, 16, 245, 11 },
    { 106, 175, 139, 181 },
    { 63, 136, 72, 76 },
    { 243, 138, 197, 193 },
    { 26, 219, 212, 42 },
    { 171, 197, 33, 252 },
    { 72, 206, 29, 254 },
    { 217, 150, 43, 85 },
    { 93, 173, 165, 203 },
    { 110, 231, 169, 71 },
    { 56, 35, 32, 224 },
    { 94, 161, 238, 194 },
    { 146, 140, 224, 52 },
    { 37, 113, 22, 137 },
    { 201, 199, 19, 225 },
    { 110, 121, 195, 34 },
    { 196, 97, 247, 93 },
    { 194, 109, 115, 142 },
    { 225, 47, 74, 23 },
    { 111, 95, 91, 255 },
    { 85, 95, 36, 63 },
    { 121, 245, 7, 146 },
    { 12, 86, 12, 160 },
    { 72, 222, 252, 37 },
    { 4, 164, 210, 32 },
    { 145, 121, 99, 25 },
    { 138, 105, 36, 60 },
    { 149, 105, 194, 58 },
    { 244, 76, 81, 149 },
    { 252, 11, 35, 27 },
    { 210, 170, 232, 80 },
    { 156, 226, 131, 248 },
    { 83, 46, 249, 49 },
    { 237, 72, 49, 102 },
    { 235, 247, 67, 86 },
    { 6, 233, 134, 203 },
    { 97, 76, 27, 161 },
    { 192, 141, 44, 180 },
    { 35, 245, 88, 208 },
    { 152, 115, 64, 86 },
    { 240, 19, 211, 119 },
    { 75, 102, 57, 228 },
    { 28, 145, 180, 253 },
    { 175, 205, 135, 37 },
    { 94, 185, 184, 50 },
    { 68, 255, 199, 76 },
    { 5, 197, 254, 19 },
    { 44, 64, 132, 57 },
    { 17, 216, 54, 224 },
    { 161, 55, 131, 235 },
    { 211, 186, 210, 188 },
    { 16, 82, 115, 30 },
    { 217, 19, 233, 56 },
    { 94, 225, 180, 115 },
    { 17, 114, 130, 82 },
    { 186, 134, 19, 49 },
    { 183, 219, 200, 129 },
    { 25, 40, 36, 241 },
    { 88, 31, 22, 245 },
    { 206, 223, 27, 64 },
    { 68, 56, 176, 12 },
    { 56, 46, 98, 32 },
    { 90, 247, 191, 220 },
    { 184, 145, 90, 94 },
    { 223, 64, 198, 167 },
    { 178, 33, 84, 40 },
    { 121, 200, 60, 145 },
    { 244, 111, 90, 134 },
    { 171, 235, 54, 43 },
    { 185, 200, 57, 37 },
    { 126, 98, 181, 212 },
    { 0, 132, 250, 198 },
    { 43, 25, 100, 101 },
    { 76, 163, 176, 95 },
    { 198, 87, 249, 15 },
    { 146, 7, 23, 77 },
    { 57, 50, 122, 39 },
    { 184, 74, 216, 176 },
    { 164, 115, 175, 1 },
    { 18, 253, 198, 242 },
    { 108, 96, 176, 229 },
    { 143, 43, 143, 62 },
    { 113, 222, 51, 6 },
    { 211, 163, 186, 165 },
    { 247, 126, 29, 32 },
    { 37, 193, 247, 234 },
    { 37, 197, 12, 69 },
    { 224, 242, 149, 196 },
    { 214, 162, 174, 25 },
    { 113, 134, 100, 105 },
    { 221, 219, 195, 153 },
    { 210, 183, 191, 233 },
    { 171, 250, 206, 19 },
    { 57, 236, 165, 39 },
    { 238, 47, 185, 172 },
    { 198, 102, 72, 63 },
    { 111, 216, 66, 83 },
    { 72, 4, 152, 13 },
    { 3, 135, 122, 216 },
    { 12, 11, 252, 26 },
    { 99, 67, 201, 124 },
    { 237, 6, 252, 26 },
    { 45, 232, 80, 13 },
    { 14, 204, 75, 100 },
    { 15, 211, 111, 225 },
    { 197, 94, 251, 253 },
    { 180, 143, 118, 32 },
    { 90, 78, 165, 136 },
    { 237, 200, 207, 179 },
    { 89, 208, 171, 96 },
    { 151, 105, 209, 130 },
    { 102, 18, 214, 235 },
    { 194, 113, 204, 26 },
    { 198, 86, 2, 188 },
    { 150, 45, 173, 188 },
    { 238, 149, 12, 210 },
    { 53, 78, 225, 49 },
    { 176, 144, 82, 229 },
    { 94, 154, 67, 181 },
    { 250, 102, 188, 176 },
    { 163, 169, 254, 200 },
    { 10, 161, 250, 19 },
    { 109, 138, 216, 54 },
    { 208, 240, 244, 31 },
    { 30, 104, 163, 192 },
    { 177, 92, 148, 96 },
    { 33, 164, 3, 66 },
    { 219, 190, 40, 205 },
    { 40, 195, 174, 164 },
    { 49, 70, 168, 143 },
    { 208, 183, 31, 180 },
    { 5, 215, 113, 44 },
    { 33, 95, 31, 120 },
    { 28, 144, 209, 89 },
    { 241, 173, 140, 247 },
    { 156, 74, 160, 79 },
    { 145, 137, 160, 0 },
    { 252, 19, 72, 11 },
    { 75, 205, 144, 245 },
    { 154, 211, 229, 32 },
    { 89, 100, 71, 168 },
    { 114, 153, 41, 213 },
    { 206, 62, 207, 60 },
    { 96, 82, 254, 40 },
    { 230, 21, 154, 29 },
    { 48, 124, 61, 150 },
    { 9, 39, 223, 157 },
    { 15, 246, 82, 104 },
    { 137, 185, 27, 152 },
    { 224, 51, 225, 255 },
    { 24, 47, 29, 75 },
    { 36, 16, 191, 57 },
    { 184, 42, 49, 200 },
    { 116, 141, 236, 57 },
    { 213, 23, 125, 72 },
    { 104, 245, 150, 76 },
    { 182, 88, 195, 171 },
    { 160, 164, 172, 230 },
    { 169, 113, 16, 185 },
    { 9, 52, 5, 70 },
    { 8, 48, 171, 236 },
    { 67, 99, 88, 79 },
    { 180, 118, 50, 235 },
    { 18, 92, 120, 160 },
    { 160, 105, 174, 3 },
    { 188, 115, 110, 101 },
    { 66, 132, 116, 252 },
    { 157, 15, 167, 235 },
    { 133, 194, 85, 83 },
    { 92, 33, 147, 9 },
    { 3, 199, 253, 28 },
    { 162, 50, 133, 85 },
    { 112, 50, 85, 179 },
    { 209, 243, 219, 227 },
    { 31, 21, 110, 158 },
    { 57, 122, 45, 199 },
    { 230, 196, 190, 51 },
    { 136, 150, 242, 38 },
    { 53, 192, 230, 211 },
    { 113, 224, 253, 226 },
    { 176, 227, 210, 237 },
    { 222, 132, 78, 40 },
    { 160, 19, 221, 211 },
    { 187, 153, 148, 11 },
    { 180, 207, 12, 166 },
    { 195, 206, 107, 197 },
    { 31, 254, 27, 114 },
    { 95, 161, 218, 185 },
    { 244, 203, 103, 195 },
    { 119, 230, 243, 68 },
    { 137, 236, 210, 222 },
    { 111, 42, 131, 240 },
    { 123, 157, 216, 61 },
    { 162, 109, 223, 246 },
    { 54, 120, 174, 153 },
    { 23, 169, 136, 15 },
    { 187, 152, 218, 230 },
    { 174, 96, 50, 102 },
    { 200, 153, 73, 136 },
    { 35, 89, 241, 40 },
    { 169, 26, 81, 60 },
    { 122, 222, 132, 178 },
    { 235, 163, 86, 24 },
    { 70, 203, 58, 41 },
    { 83, 164, 119, 118 },
    { 226, 15, 231, 180 },
    { 60, 181, 83, 110 },
    { 104, 136, 17, 239 },
    { 165, 161, 223, 31 },
    { 125, 9, 210, 15 },
    { 48, 159, 246, 107 },
    { 70, 141, 162, 162 },
    { 144, 189, 12, 34 },
    { 187, 89, 56, 55 },
    { 185, 97, 37, 53 },
    { 209, 160, 238, 173 },
    { 95, 7, 153, 79 },
    { 157, 177, 192, 58 },
    { 65, 219, 177, 34 },
    { 23, 129, 27, 77 },
    { 115, 247, 36, 161 },
    { 250, 204, 45, 1 },
    { 169, 171, 234, 229 },
    { 36, 26, 161, 228 },
    { 23, 95, 253, 77 },
    { 101, 232, 190, 208 },
    { 147, 136, 32, 114 },
    { 142, 138, 226, 79 },
    { 248, 86, 19, 128 },
    { 187, 47, 150, 172 },
    { 195, 83, 219, 196 },
    { 125, 175, 57, 10 },
    { 52, 32, 149, 116 },
    { 224, 43, 166, 236 },
    { 34, 13, 69, 213 },
    { 250, 43, 161, 25 },
    { 11, 218, 123, 174 },
    { 71, 84, 138, 13 },
    { 215, 60, 18, 28 },
    { 96, 136, 208, 235 },
    { 174, 13, 35, 131 },
    { 105, 108, 186, 31 },
    { 79, 165, 11, 111 },
    { 83, 20, 111, 253 },
    { 216, 41, 31, 166 },
    { 214, 161, 165, 119 },
    { 78, 65, 11, 141 },
    { 113, 60, 140, 125 },
    { 35, 129, 116, 22 },
    { 205, 207, 240, 132 },
    { 24, 206, 60, 65 },
    { 14, 55, 16, 198 },
    { 23, 232, 188, 87 },
    { 200, 12, 193, 248 },
    { 2, 31, 110, 176 },
    { 113, 95, 204, 36 },
    { 35, 19, 9, 52 },
    { 6, 14, 206, 216 },
    { 234, 183, 89, 38 },
    { 91, 39, 120, 215 },
    { 69, 4, 157, 24 },
    { 57, 45, 24, 11 },
    { 31, 18, 209, 98 },
    { 106, 99, 181, 253 },
    { 190, 184, 232, 50 },
    { 96, 86, 154, 26 },
    { 231, 80, 50, 144 },
    { 61, 73, 245, 51 },
    { 67, 121, 38, 202 },
    { 43, 84, 136, 8 },
    { 212, 98, 134, 93 },
    { 76, 175, 249, 52 },
    { 114, 47, 54, 89 },
    { 167, 17, 30, 93 },
    { 228, 88, 166, 245 },
    { 247, 160, 66, 112 },
    { 201, 72, 64, 123 },
    { 119, 71, 192, 214 },
    { 212, 18, 115, 120 },
    { 220, 164, 120, 196 },
    { 142, 56, 171, 62 },
    { 254, 144, 214, 237 },
    { 247, 81, 30, 250 },
    { 67, 205, 213, 127 },
    { 15, 54, 14, 118 },
    { 212, 11, 53, 223 },
    { 118, 100, 245, 163 },
    { 13, 118, 222, 209 },
    { 223, 33, 153, 102 },
    { 10, 245, 134, 184 },
    { 23, 200, 228, 70 },
    { 140, 82, 4, 177 },
    { 19, 141, 109, 199 },
    { 116, 188, 183, 171 },
    { 183, 132, 73, 141 },
    { 144, 170, 217, 37 },
    { 66, 58, 211, 104 },
    { 186, 103, 66, 15 },
    { 92, 32, 215, 238 },
    { 160, 113, 187, 60 },
    { 37, 213, 182, 118 },
    { 138, 237, 155, 61 },
    { 69, 89, 246, 34 },
    { 202, 221, 215, 254 },
    { 184, 18, 97, 224 },
    { 17, 94, 216, 17 },
    { 193, 219, 203, 163 },
    { 146, 97, 146, 58 },
    { 108, 32, 127, 88 },
    { 172, 88, 113, 252 },
    { 213, 241, 139, 33 },
    { 179, 60, 91, 118 },
    { 181, 158, 157, 128 },
    { 170, 247, 246, 228 },
    { 19, 253, 52, 176 },
    { 201, 200, 88, 172 },
    { 102, 25, 162, 249 },
    { 95, 25, 11, 242 },
    { 29, 49, 19, 71 },
    { 120, 75, 93, 8 },
    { 84, 187, 116, 94 },
    { 231, 246, 61, 157 },
    { 170, 71, 87, 96 },
    { 222, 56, 64, 122 },
    { 7, 184, 59, 164 },
    { 149, 39, 129, 163 },
    { 67, 140, 66, 13 },
    { 81, 119, 9, 228 },
    { 132, 103, 47, 74 },
    { 94, 47, 159, 122 },
    { 181, 131, 1, 169 },
    { 151, 139, 211, 224 },
    { 198, 231, 88, 19 },
    { 178, 81, 114, 219 },
    { 189, 171, 244, 163 },
    { 39, 236, 140, 230 },
    { 195, 84, 91, 89 },
    { 127, 4, 53, 186 },
    { 160, 204, 89, 220 },
    { 23, 37, 140, 201 },
    { 138, 228, 106, 5 },
    { 207, 28, 51, 11 },
    { 67, 38, 61, 211 },
    { 135, 208, 237, 250 },
    { 84, 228, 100, 212 },
    { 128, 165, 150, 246 },
    { 209, 171, 193, 124 },
    { 65, 184, 68, 226 },
    { 67, 163, 208, 168 },
    { 13, 99, 142, 180 },
    { 82, 234, 83, 45 },
    { 126, 64, 57, 97 },
    { 143, 232, 60, 106 },
    { 26, 102, 109, 112 },
    { 5, 246, 18, 87 },
    { 76, 234, 94, 197 },
    { 175, 28, 227, 240 },
    { 72, 69, 68, 121 },
    { 1, 237, 40, 182 },
    { 72, 9, 215, 163 },
    { 52, 65, 31, 217 },
    { 164, 124, 247, 97 },
    { 6, 121, 95, 255 },
    { 60, 190, 188, 9 },
    { 185, 228, 32, 182 },
    { 83, 3, 73, 23 },
    { 15, 227, 20, 142 },
    { 6, 200, 250, 178 },
    { 207, 105, 229, 202 },
    { 240, 214, 230, 209 },
    { 76, 199, 65, 11 },
    { 179, 59, 212, 86 },
    { 192, 1, 150, 83 },
    { 253, 243, 238, 7 },
    { 13, 250, 17, 27 },
    { 40, 40, 53, 0 },
    { 213, 130, 156, 86 },
    { 245, 128, 155, 118 },
    { 50, 235, 122, 120 },
    { 171, 215, 186, 241 },
    { 242, 223, 240, 220 },
    { 99, 196, 141, 244 },
    { 238, 231, 89, 15 },
    { 199, 157, 59, 172 },
    { 227, 84, 175, 103 },
    { 178, 101, 23, 151 },
    { 55, 5, 36, 175 },
    { 247, 42, 41, 247 },
    { 93, 219, 113, 158 },
    { 124, 12, 44, 118 },
    { 1, 128, 107, 102 },
    { 227, 142, 81, 232 },
    { 243, 194, 86, 20 },
    { 202, 110, 179, 186 },
    { 234, 196, 192, 58 },
    { 187, 255, 242, 213 },
    { 12, 31, 181, 232 },
    { 198, 81, 183, 140 },
    { 8, 116, 247, 101 },
    { 103, 76, 28, 157 },
    { 86, 175, 249, 130 },
    { 238, 193, 203, 72 },
    { 121, 181, 81, 217 },
    { 17, 34, 49, 187 },
    { 76, 251, 88, 202 },
    { 170, 75, 126, 90 },
};

  volatile int c = 0;
  digitalWrite(reset, 1); // set reset high
  while (c < 10000) {c++;}
  c = 0;
  digitalWrite(reset, 0); // set reset low

  digitalWrite(MSPI, 0); // Initialize MSPI low
  digitalWrite(finalPixel, 0); // Initialize finalPixel low

  char bytes[6500]; 

  for (int count = 0; count < 6500; count++) {
    bytes[count] = 0xCC;
  }

  // start 14 byte header
  bytes[0] = 0x71; // q
  bytes[1] = 0x6F; // o
  bytes[2] = 0x69; // i
  bytes[3] = 0x66; // f

  uint32_t width = 40;
  uint32_t height = 30;

  // Smiley face attempt
  for (int b = 0; b < 1200; b++) {
    pixels[b].r = 0x00;
    pixels[b].g = 0x00;
    pixels[b].b = 0x00;
    pixels[b].a = 0xff;
  }

  pixels[293-1].r = 0x00;
  pixels[293-1].g = 0xFF;
  pixels[293-1].b = 0x00;
  pixels[293-1].a = 0xFF;
  pixels[293+15].r = 0x00;
  pixels[293+15].g = 0xFF;
  pixels[293+15].b = 0x00;
  pixels[293+15].a = 0xFF;
  for (int b = 0; b < 15; b++) {
    pixels[733 + b].r = 0x00;
    pixels[733 + b].g = 0xFF;
    pixels[733 + b].b = 0x00;
    pixels[733 + b].a = 0xFF;
  }
  for (int b = 0; b < 4; b++) {
    pixels[573 + (40*b)].r = 0x00;
    pixels[573 + (40*b)].g = 0xFF;
    pixels[573 + (40*b)].b = 0x00;
    pixels[573 + (40*b)].a = 0xFF;
  }
  for (int b = 0; b < 4; b++) {
    pixels[587 + (40*b)].r = 0x00;
    pixels[587 + (40*b)].g = 0xFF;
    pixels[587 + (40*b)].b = 0x00;
    pixels[587 + (40*b)].a = 0xFF;
  }
  // end smiley face attempt


  // 14 byte header
  bytes[4] = ((width >> 24) & 0xFF);
  bytes[5] = ((width >> 16) & 0xFF);
  bytes[6] = ((width >> 8) & 0xFF);
  bytes[7] = (width & 0xFF);
  bytes[8] = ((height >> 24) & 0xFF);
  bytes[9] = ((height >> 16) & 0xFF);
  bytes[10] = ((height >> 8) & 0xFF);
  bytes[11] = (height & 0xFF);
  bytes[12] = 4;
  bytes[13] = 1;
  // end 14 byte header

  // polarity = 0, phase = 1
  initSPI(5, 0, 1);
  
  int i = 0;
  volatile int j = 14;
  while (i < numPixels) {
    if (digitalRead(readyForPixel)) {
      if (i == (numPixels - 1)) {
        digitalWrite(finalPixel, 1);
      }
      spiSendReceive(pixels[i].r);
      while(SPI1->SR & SPI_SR_BSY);
      spiSendReceive(pixels[i].g);
      while(SPI1->SR & SPI_SR_BSY);
      spiSendReceive(pixels[i].b);
      while(SPI1->SR & SPI_SR_BSY);
      spiSendReceive(pixels[i].a);
      while(SPI1->SR & SPI_SR_BSY);
      digitalWrite(MSPI, 1);
      while (c < 100) {c++;}
      c = 0;
      digitalWrite(MSPI, 0);
      i++;
    }
    if (digitalRead(encodedByteReady)) {
      bytes[j] = spiSendReceive(0xF);
      while(SPI1->SR & SPI_SR_BSY);
      digitalWrite(MSPI, 1);
      while (c < 100) {c++;}
      c = 0;
      digitalWrite(MSPI, 0);
      j++;
    }
  }

  while(!digitalRead(doneEncoding)) {
    if (digitalRead(encodedByteReady)) {
      bytes[j] = spiSendReceive(0xF);
      while(SPI1->SR & SPI_SR_BSY);
      digitalWrite(MSPI, 1);
      while (c < 100) {c++;}
      c = 0;
      digitalWrite(MSPI, 0);
      j++;
    }
  }


  // 8 byte end marker
  bytes[j] = 0x00;
  bytes[j+1] = 0x00;
  bytes[j+2] = 0x00;
  bytes[j+3] = 0x00;
  bytes[j+4] = 0x00;
  bytes[j+5] = 0x00;
  bytes[j+6] = 0x00;
  bytes[j+7] = 0x01;

   while(1);



}
